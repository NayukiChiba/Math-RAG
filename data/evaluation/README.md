# è¯„æµ‹æ•°æ®é›†è¯´æ˜

## æ–‡ä»¶ç»“æ„

### queries.jsonlï¼ˆå¿«é€ŸéªŒè¯é›†ï¼‰

**ç”¨é€”**ï¼šå¿«é€ŸéªŒè¯è¯„æµ‹æµç¨‹å’Œç®—æ³•è¿­ä»£

**è§„æ¨¡**ï¼š105 æ¡æŸ¥è¯¢
- æ•°å­¦åˆ†æï¼š53 æ¡ï¼ˆ50.5%ï¼‰
- æ¦‚ç‡è®ºï¼š26 æ¡ï¼ˆ24.8%ï¼‰
- é«˜ç­‰ä»£æ•°ï¼š26 æ¡ï¼ˆ24.8%ï¼‰

**ç‰¹ç‚¹**ï¼š
- äººå·¥ç²¾é€‰ + è‡ªåŠ¨ç”Ÿæˆæ··åˆ
- è¦†ç›–å…¸å‹æŸ¥è¯¢åœºæ™¯
- è¯„æµ‹é€Ÿåº¦å¿«ï¼ˆ~10ç§’ï¼‰

### queries_full.jsonlï¼ˆå®Œæ•´è¯„æµ‹é›†ï¼‰

**ç”¨é€”**ï¼šæœ€ç»ˆè¯„æµ‹ã€è®ºæ–‡å®éªŒå’Œå…¨é¢æ€§èƒ½åˆ†æ

**è§„æ¨¡**ï¼š3102 æ¡æŸ¥è¯¢ï¼ˆè¦†ç›–æ•´ä¸ªæœ¯è¯­åº“ï¼‰
- æ•°å­¦åˆ†æï¼š1547 æ¡ï¼ˆ49.9%ï¼‰
- æ¦‚ç‡è®ºï¼š910 æ¡ï¼ˆ29.3%ï¼‰
- é«˜ç­‰ä»£æ•°ï¼š645 æ¡ï¼ˆ20.8%ï¼‰

**ç‰¹ç‚¹**ï¼š
- 100% è‡ªåŠ¨ç”Ÿæˆ
- å®Œæ•´è¦†ç›–æ‰€æœ‰æœ¯è¯­
- è¯„æµ‹æ—¶é—´è¾ƒé•¿ï¼ˆ~5-10åˆ†é’Ÿï¼‰

### æŸ¥è¯¢æ ¼å¼

æ¯è¡Œä¸€ä¸ªæŸ¥è¯¢ï¼ŒJSON æ ¼å¼ï¼š

```json
{
  "query": "ä¸€è‡´æ”¶æ•›",
  "relevant_terms": ["ä¸€è‡´æ”¶æ•›"],
  "subject": "æ•°å­¦åˆ†æ"
}
```

**å­—æ®µè¯´æ˜**ï¼š
- `query`ï¼šç”¨æˆ·æŸ¥è¯¢æ–‡æœ¬ï¼ˆå¿…å¡«ï¼‰
- `relevant_terms`ï¼šç›¸å…³æœ¯è¯­åˆ—è¡¨ï¼Œç”¨äºè¯„æµ‹ï¼ˆå¿…å¡«ï¼‰
  - æŒ‰ç›¸å…³æ€§ä»é«˜åˆ°ä½æ’åº
  - ç¬¬ä¸€ä¸ªæœ¯è¯­é€šå¸¸æ˜¯æœ€ç›¸å…³çš„ï¼ˆç²¾ç¡®åŒ¹é…æˆ–ä¸»è¦æ¦‚å¿µï¼‰
  - åç»­æœ¯è¯­ä¸ºç›¸å…³æ¦‚å¿µã€åŒä¹‰è¯ã€åˆ«åç­‰
- `subject`ï¼šæ‰€å±å­¦ç§‘ï¼ˆå¿…å¡«ï¼‰ï¼Œå¯é€‰å€¼ï¼š
  - `æ•°å­¦åˆ†æ`
  - `é«˜ç­‰ä»£æ•°`
  - `æ¦‚ç‡è®º`

## ä½¿ç”¨å»ºè®®

| åœºæ™¯ | æ¨èæ–‡ä»¶ | ç†ç”± |
|------|----------|------|
| ğŸ”§ å¼€å‘è°ƒè¯• | queries.jsonl | å¿«é€Ÿåé¦ˆï¼ŒèŠ‚çœæ—¶é—´ |
| ğŸš€ ç®—æ³•è¿­ä»£ | queries.jsonl | å¿«é€ŸéªŒè¯æ”¹è¿›æ•ˆæœ |
| ğŸ“Š å¯¹æ¯”å®éªŒ | queries.jsonl | å¿«é€Ÿå¯¹æ¯”å¤šç§æ–¹æ³• |
| ğŸ“ è®ºæ–‡å®éªŒ | queries_full.jsonl | å®Œæ•´æ•°æ®ï¼Œç»“æœå¯é  |
| ğŸ¯ æœ€ç»ˆè¯„æµ‹ | queries_full.jsonl | å…¨é¢è¯„ä¼°ç³»ç»Ÿæ€§èƒ½ |

## è‡ªåŠ¨ç”Ÿæˆå·¥å…·

å¯ä»¥ä½¿ç”¨ `evaluation/generateQueries.py` è„šæœ¬ä»æœ¯è¯­åº“è‡ªåŠ¨ç”Ÿæˆè¯„æµ‹æ•°æ®ï¼š

```bash
# é»˜è®¤ï¼šæŒ‰å›ºå®šæ•°é‡ç”Ÿæˆï¼ˆæ•°å­¦åˆ†æ35ï¼Œé«˜ç­‰ä»£æ•°20ï¼Œæ¦‚ç‡è®º20ï¼‰
python evaluation/generateQueries.py

# ç”Ÿæˆæ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„æœ¯è¯­ï¼ˆ3102æ¡ï¼‰
python evaluation/generateQueries.py --all

# æŒ‰æ¯”ä¾‹é‡‡æ ·ï¼ˆå¦‚50%ï¼‰
python evaluation/generateQueries.py --ratio 0.5

# è‡ªå®šä¹‰å„å­¦ç§‘æ•°é‡
python evaluation/generateQueries.py --num-ma 50 --num-gd 30 --num-gl 30
```

**åŠŸèƒ½ç‰¹ç‚¹**ï¼š
- æ™ºèƒ½é‡‡æ ·é«˜è´¨é‡æœ¯è¯­ï¼ˆ80% é«˜è´¨é‡ + 20% éšæœºï¼‰
- è‡ªåŠ¨æå–ç›¸å…³æœ¯è¯­ï¼ˆaliases + related_termsï¼‰
- æŒ‰å­¦ç§‘åˆ†ç±»ç”Ÿæˆï¼Œä¿è¯åˆ†å¸ƒå‡è¡¡
- ä¸ç°æœ‰æ•°æ®åˆå¹¶ï¼Œè‡ªåŠ¨å»é‡

**ç”Ÿæˆç­–ç•¥**ï¼š
- ä¼˜å…ˆé€‰æ‹©ç›¸å…³æœ¯è¯­ä¸°å¯Œçš„æœ¯è¯­
- è‡ªåŠ¨æ„å»º relevant_termsï¼š`term + aliases + related_terms`
- æ™ºèƒ½ç­›é€‰ç›¸å…³æœ¯è¯­ï¼ˆä¼˜å…ˆåŒ…å«æŸ¥è¯¢è¯çš„ç›¸å…³æœ¯è¯­ï¼‰

**ç”Ÿæˆè§„æ¨¡**ï¼š

| æ¨¡å¼ | å‚æ•° | æ€»æŸ¥è¯¢æ•° | é€‚ç”¨åœºæ™¯ |
|------|------|----------|----------|
| é»˜è®¤ | æ—  | ~75 æ¡ | å¿«é€ŸéªŒè¯è¯„æµ‹æµç¨‹ |
| ä¸­ç­‰è§„æ¨¡ | `--ratio 0.3` | ~900 æ¡ | å¹³è¡¡è¦†ç›–åº¦å’Œæ•ˆç‡ |
| å…¨é‡ | `--all` | **3102 æ¡** | å®Œæ•´è¯„æµ‹å’Œè®ºæ–‡å®éªŒ |

è¯¦è§ [evaluation/README.md](../../evaluation/README.md#generatequeriespy) äº†è§£æ›´å¤šã€‚

## æ‰©å±•æŒ‡å—

å»ºè®®æ‰©å±•åˆ° 50-100 æ¡æŸ¥è¯¢ï¼Œè¦†ç›–ä»¥ä¸‹åœºæ™¯ï¼š

### 1. æŸ¥è¯¢ç±»å‹
- **ç²¾ç¡®åŒ¹é…**ï¼šæŸ¥è¯¢ä¸æœ¯è¯­åç§°å®Œå…¨ä¸€è‡´ï¼ˆå¦‚ "è¾¾å¸ƒå®šç†"ï¼‰
- **åˆ«åæŸ¥è¯¢**ï¼šä½¿ç”¨æœ¯è¯­çš„åˆ«åæˆ–åŒä¹‰è¯ï¼ˆå¦‚ "æ´›å¿…å¡”" vs "æ´›å¿…è¾¾æ³•åˆ™"ï¼‰
- **ç›¸å…³æ¦‚å¿µ**ï¼šæŸ¥è¯¢ç›¸å…³ä½†ä¸å®Œå…¨ä¸€è‡´çš„æœ¯è¯­ï¼ˆå¦‚ "æ”¶æ•›" åº”è¿”å› "ä¸€è‡´æ”¶æ•›"ã€"é€ç‚¹æ”¶æ•›"ï¼‰
- **æ¨¡ç³ŠæŸ¥è¯¢**ï¼šåŒ…å«é”™åˆ«å­—æˆ–ä¸å®Œæ•´çš„æŸ¥è¯¢ï¼ˆå¯é€‰ï¼‰

### 2. éš¾åº¦åˆ†çº§
- **ç®€å•æŸ¥è¯¢**ï¼šæœ¯è¯­åç§°å”¯ä¸€ï¼Œæ— æ­§ä¹‰ï¼ˆå¦‚ "è¾¾å¸ƒå®šç†"ï¼‰
- **ä¸­ç­‰æŸ¥è¯¢**ï¼šæœ‰å¤šä¸ªç›¸å…³æœ¯è¯­ï¼Œéœ€è¦æ’åºï¼ˆå¦‚ "æ”¶æ•›"ï¼‰
- **å›°éš¾æŸ¥è¯¢**ï¼šæœ‰æ­§ä¹‰æˆ–è·¨å­¦ç§‘çš„æ¦‚å¿µï¼ˆå¦‚ "è¿ç»­"ï¼‰

### 3. å­¦ç§‘è¦†ç›–
ç¡®ä¿ä¸‰ä¸ªå­¦ç§‘çš„æŸ¥è¯¢æ•°é‡å‡è¡¡ï¼š
- æ•°å­¦åˆ†æï¼š40-50%
- é«˜ç­‰ä»£æ•°ï¼š25-30%
- æ¦‚ç‡è®ºï¼š25-30%

## æ ‡æ³¨åŸåˆ™

### relevant_terms æ ‡æ³¨è§„åˆ™

1. **ç¬¬ä¸€ä¸ªæœ¯è¯­**ï¼šæœ€ç›¸å…³çš„æœ¯è¯­ï¼ˆé€šå¸¸æ˜¯ç²¾ç¡®åŒ¹é…ï¼‰
2. **åç»­æœ¯è¯­**ï¼šæŒ‰ç›¸å…³æ€§é€’å‡æ’åºï¼ŒåŒ…æ‹¬ï¼š
   - åŒä¹‰è¯/åˆ«å
   - ç›¸å…³æ¦‚å¿µ
   - çˆ¶æ¦‚å¿µæˆ–å­æ¦‚å¿µ
   - å…³è”å®šç†/å…¬å¼

3. **æ•°é‡å»ºè®®**ï¼š
   - ç®€å•æŸ¥è¯¢ï¼š1-2 ä¸ªæœ¯è¯­
   - ä¸­ç­‰æŸ¥è¯¢ï¼š3-5 ä¸ªæœ¯è¯­
   - å›°éš¾æŸ¥è¯¢ï¼š5-10 ä¸ªæœ¯è¯­

### ç¤ºä¾‹

```json
// ç®€å•æŸ¥è¯¢ï¼ˆç²¾ç¡®åŒ¹é…ï¼‰
{"query": "è¾¾å¸ƒå®šç†", "relevant_terms": ["è¾¾å¸ƒå®šç†"], "subject": "æ•°å­¦åˆ†æ"}

// ä¸­ç­‰æŸ¥è¯¢ï¼ˆæœ‰åŒä¹‰è¯ï¼‰
{"query": "æ³°å‹’å±•å¼€", "relevant_terms": ["æ³°å‹’å±•å¼€", "æ³°å‹’å…¬å¼", "æ³°å‹’çº§æ•°"], "subject": "æ•°å­¦åˆ†æ"}

// å›°éš¾æŸ¥è¯¢ï¼ˆå¤šä¸ªç›¸å…³æ¦‚å¿µï¼‰
{"query": "ä¸­å€¼å®šç†", "relevant_terms": ["ä¸­å€¼å®šç†", "æ‹‰æ ¼æœ—æ—¥ä¸­å€¼å®šç†", "ç½—å°”å®šç†", "æŸ¯è¥¿ä¸­å€¼å®šç†"], "subject": "æ•°å­¦åˆ†æ"}
```

## è´¨é‡æ£€æŸ¥

æ·»åŠ æ–°æŸ¥è¯¢å‰ï¼Œè¯·æ£€æŸ¥ï¼š
- [ ] `query` å­—æ®µæ˜¯å¦ä¸ºå®é™…ç”¨æˆ·å¯èƒ½è¾“å…¥çš„æŸ¥è¯¢
- [ ] `relevant_terms` ä¸­çš„æœ¯è¯­æ˜¯å¦åœ¨ corpus.jsonl ä¸­å­˜åœ¨
- [ ] `relevant_terms` çš„é¡ºåºæ˜¯å¦æŒ‰ç›¸å…³æ€§é€’å‡
- [ ] `subject` å­—æ®µæ˜¯å¦æ­£ç¡®

## éªŒè¯å·¥å…·

å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤éªŒè¯æ•°æ®é›†æ ¼å¼ï¼š

```bash
python -c "
import json
with open('data/evaluation/queries.jsonl', 'r', encoding='utf-8') as f:
    for i, line in enumerate(f, 1):
        try:
            data = json.loads(line)
            assert 'query' in data
            assert 'relevant_terms' in data
            assert 'subject' in data
            assert isinstance(data['relevant_terms'], list)
            assert len(data['relevant_terms']) > 0
        except Exception as e:
            print(f'âŒ ç¬¬ {i} è¡Œæ ¼å¼é”™è¯¯: {e}')
            break
    else:
        print(f'âœ… æ•°æ®é›†æ ¼å¼æ­£ç¡®ï¼Œå…± {i} æ¡æŸ¥è¯¢')
"
```
